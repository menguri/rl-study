  0%|                                                                        | 0/30000 [00:00<?, ?it/s]/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/A2C.py:209: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:254.)
  states_t = torch.tensor(states, dtype=torch.float32, device=self.device)
104
104
tensor([ 0.0789,  0.0664,  0.0255,  0.0578,  0.0584,  0.1060,  0.1393,  0.0745,
        -0.0107,  0.0073,  0.0388,  0.0205, -0.0168, -0.0420, -0.0982, -0.0331,
        -0.1036, -0.0575, -0.0275, -0.0523, -0.0658, -0.0229,  0.0912,  0.0502,
         0.0324,  0.0996,  0.0850,  0.1513,  0.1082,  0.0873,  0.1538,  0.1015,
         0.2035,  0.1228,  0.1776,  0.1379,  0.1574,  0.1293,  0.1144,  0.1377,
         0.0921,  0.0260,  0.0372,  0.1377,  0.1405,  0.1316,  0.1459,  0.1759,
         0.1442,  0.1663,  0.1481,  0.1605,  0.1479,  0.0510,  0.1105,  0.1275,
         0.1079,  0.1142,  0.1629,  0.1417,  0.0875,  0.1341,  0.2434,  0.1321,
         0.1037,  0.0688, -0.0420,  0.0025,  0.0288, -0.0313, -0.0992, -0.0905,
        -0.0986, -0.1405, -0.0913, -0.0905, -0.1031, -0.1087,  0.0415, -0.0784,
        -0.1435, -0.0446, -0.0851, -0.0493, -0.0208,  0.0034, -0.0805, -0.1170,
        -0.0530,  0.0340, -0.0407, -0.0722, -0.1206, -0.0822, -0.0695, -0.0513,
        -0.0131,  0.0709, -0.0394,  0.1057,  0.1315,  0.0426,  0.0173,  0.0052],
       device='cuda:0', grad_fn=<SqueezeBackward1>)
tensor([ 0.0664,  0.0255,  0.0578,  0.0584,  0.1060,  0.1393,  0.0745, -0.0107,
         0.0073,  0.0388,  0.0205, -0.0168, -0.0420, -0.0982, -0.0331, -0.1036,
        -0.0575, -0.0275, -0.0523, -0.0658, -0.0229,  0.0912,  0.0502,  0.0324,
         0.0996,  0.0850,  0.1513,  0.1082,  0.0873,  0.1538,  0.1015,  0.2035,
         0.1228,  0.1776,  0.1379,  0.1574,  0.1293,  0.1144,  0.1377,  0.0921,
         0.0260,  0.0372,  0.1377,  0.1405,  0.1316,  0.1459,  0.1759,  0.1442,
         0.1663,  0.1481,  0.1605,  0.1479,  0.0510,  0.1105,  0.1275,  0.1079,
         0.1142,  0.1629,  0.1417,  0.0875,  0.1341,  0.2434,  0.1321,  0.1037,
         0.0688, -0.0420,  0.0025,  0.0288, -0.0313, -0.0992, -0.0905, -0.0986,
        -0.1405, -0.0913, -0.0905, -0.1031, -0.1087,  0.0415, -0.0784, -0.1435,
        -0.0446, -0.0851, -0.0493, -0.0208,  0.0034, -0.0805, -0.1170, -0.0530,
         0.0340, -0.0407, -0.0722, -0.1206, -0.0822, -0.0695, -0.0513, -0.0131,
         0.0709, -0.0394,  0.1057,  0.1315,  0.0426,  0.0173,  0.0052, -0.1389],
       device='cuda:0', grad_fn=<SqueezeBackward1>)
  0%|                                                                        | 0/30000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 53, in <module>
    main()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 47, in main
    agent.train()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/A2C.py", line 105, in train
    self.update_critic(states, actions, rewards, next_states, dones)
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/A2C.py", line 223, in update_critic
    target_v = rewards_t + (1 - dones_t) * self.gamma * v_s_next
RuntimeError: The size of tensor a (208) must match the size of tensor b (104) at non-singleton dimension 0
Traceback (most recent call last):
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 53, in <module>
    main()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 47, in main
    agent.train()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/A2C.py", line 105, in train
    self.update_critic(states, actions, rewards, next_states, dones)
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/A2C.py", line 223, in update_critic
    target_v = rewards_t + (1 - dones_t) * self.gamma * v_s_next
RuntimeError: The size of tensor a (208) must match the size of tensor b (104) at non-singleton dimension 0
