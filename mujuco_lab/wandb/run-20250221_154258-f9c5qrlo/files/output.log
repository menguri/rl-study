  0%|                                                                                | 0/1000 [00:00<?, ?it/s]
tensor([-142.8690, -144.4766, -146.0394, -145.9448, -146.6187, -147.8986,
        -149.9069, -150.7412, -150.7112, -149.9008, -150.1225, -150.9573,
        -151.6682, -152.5319, -153.3516, -153.5511, -153.4317, -152.1651,
        -152.2420, -152.6208, -151.7322, -147.2551, -144.0431, -142.0388,
        -138.0159, -138.7142, -138.6456, -137.7023, -137.6315, -136.5299,
        -135.9014, -135.0694, -136.2868, -137.3943, -137.3579, -135.9576,
        -134.6322, -135.8117, -137.1110, -136.5346, -134.8214, -133.9973,
        -133.6637, -134.7235, -134.3264, -134.8367, -135.3724, -135.9730,
        -136.3636, -135.8093, -133.2579, -132.2697, -132.4390, -133.5753,
        -133.2611, -131.7828, -130.7733, -130.7284, -130.8169, -129.6233,
        -129.6360, -128.4894, -126.1642, -124.3600, -125.0407, -124.7561,
        -124.0312, -122.1665, -121.2761, -121.6982, -121.2008, -120.2795,
        -117.1488, -114.9234, -115.1887, -113.8056, -110.5991, -109.8189,
        -109.0412, -109.1137, -108.7413, -107.4185, -106.2369, -104.8068,
        -105.7551, -105.6569, -105.5000, -106.2928, -106.6380, -107.0847,
        -106.8930, -106.5066, -105.0800, -103.6373, -104.9018, -106.0415,
        -102.8346, -102.6910, -100.1073, -100.5536,  -99.0409,  -99.3882,
        -100.0382, -101.0617, -101.9102, -102.7135, -103.3837, -103.5186,
        -102.9748, -104.3450, -105.5136, -106.5884, -108.3186, -109.9311,
        -111.3122, -112.8473, -113.8132, -114.0890, -113.7644, -112.0671,
        -113.1029, -115.1039, -117.0255, -118.4953, -119.8611, -120.3759,
        -121.2282, -120.8133, -121.9270, -123.9844, -126.5409, -124.7411,
        -125.6306, -126.9097, -129.1011, -130.0032, -130.0267, -128.5477,
        -129.6803, -130.0995, -129.8425, -129.0946, -128.4407, -128.2959,
        -129.7678, -127.7444, -126.9320, -126.5346, -125.5454, -126.5389,
        -127.1568, -128.0619, -128.6205, -129.2736, -128.6578, -128.3390,
        -128.8219, -129.9579, -130.5808, -131.2777, -131.7696, -131.9097,
        -132.6152, -131.6055, -130.3584, -125.4946, -126.0326, -126.0956,
        -126.9723, -127.0941, -127.3007, -124.1034, -125.1474, -126.1920,
        -126.5095, -125.5670, -126.2802, -126.1639, -125.4101, -126.0746,
        -126.3510, -127.1351, -128.8896, -129.0921, -129.1742, -127.9767,
        -127.0649, -128.9497, -128.7658, -128.2617, -127.5743, -126.7203,
        -127.5939, -128.0827, -128.9270, -128.6102, -127.5820, -127.9198,
        -128.3060, -129.3899, -129.4052, -129.4066, -129.9718, -130.2755,
        -131.8167, -131.3748, -130.8685, -130.3323, -126.9868, -128.1233,
        -127.2077, -126.5665, -125.0472, -125.3263, -125.5435, -126.4757,
        -126.8104, -127.7278, -127.7595, -128.6415, -122.2090, -122.7109,
        -121.9126, -120.8491, -121.4211, -122.2008, -121.5153, -121.5306,
        -119.6615, -119.6568, -121.4148, -121.6555, -120.8637, -119.2311,
        -118.1010, -118.8764, -118.4198, -118.1434, -116.8834, -117.4518,
        -117.3190, -117.4526, -117.9907, -117.2626, -117.6179, -118.3280,
        -113.7564, -114.3480, -113.3612, -113.1928, -113.5346, -114.4314,
        -116.2624, -116.0836, -116.3871, -116.8125, -117.0496, -117.2215,
        -117.6604, -117.7549, -117.8235, -117.3676, -118.2146, -118.3191,
        -118.6180, -118.8706, -120.0716, -120.9250, -120.6145, -120.9016,
        -120.2381, -120.8131, -117.4653, -117.8978, -119.0862, -120.1435,
        -119.8490, -119.9796, -118.4488, -120.0850, -120.2956, -118.6193,
        -118.8306, -118.5732, -115.9027, -115.8095, -113.4908, -113.3845,
        -113.7078, -115.5236, -117.4107, -118.0387, -118.4569, -118.4822,
        -118.4667, -119.6415, -120.3343, -121.4804, -120.6000, -119.9672,
        -119.5779, -119.4577, -119.8598, -120.1058, -120.8475, -121.1855,
        -119.4238, -120.4189, -121.7877, -123.0690, -122.9579, -124.0320,
        -125.2153, -125.9158, -127.5032, -128.0179, -127.9605, -127.4049,
        -125.9705, -125.5310, -127.1844, -126.3660, -127.5366, -126.7075,
        -127.2936, -128.0138, -128.9992, -129.2461, -129.0631, -129.6872,
        -130.5412, -129.4743, -129.4389, -128.6485, -128.0661, -127.9792,
        -127.4742, -127.7050, -127.8114, -112.3427, -111.6048, -112.2382,
        -112.5963, -113.3026, -113.2751, -112.9306, -113.2451, -112.1888,
        -112.0391, -112.4371, -113.3726, -112.7436, -113.2281, -112.3337,
        -112.9999, -113.3225, -113.6765, -113.6377, -113.8101, -114.4243,
        -113.1499, -112.1486, -112.3718, -112.0212, -110.6953, -110.5193,
        -110.5874, -108.0784, -108.9393, -109.8446, -109.6137, -109.0695,
        -108.3293, -106.3463, -103.1776, -103.4786, -103.5779, -104.5949,
        -105.7093, -106.9158, -105.5735, -104.6348, -103.1064, -103.0594,
        -102.7674, -103.2088, -101.9695, -101.3915, -102.4180, -101.8957,
        -103.1828, -103.7679, -103.6363, -103.2287, -104.3474, -104.9672,
        -104.0327, -103.3888, -102.2567, -101.8522, -101.7130, -102.4746,
        -101.9175, -101.8131, -100.9868, -101.9429, -103.2028, -103.6488,
        -104.2789, -105.1411, -106.3237, -106.9418, -107.5852, -107.9857,
        -108.8453, -109.9307, -110.1496, -111.2285, -111.0815, -111.2895,
        -110.8209, -112.1901, -112.7263, -110.7089, -110.3351, -109.8147,
        -110.6432, -111.7924, -112.0294, -111.4530, -112.3123, -112.4596,
        -113.4367, -112.9928, -112.7389, -113.7177, -113.1455, -113.4811,
        -111.4162, -111.7587, -112.3683, -111.8957, -112.2832, -113.2793,
        -112.3269, -112.2337, -111.8516, -111.4212, -113.0748, -114.8201,
        -115.3168, -114.0229, -112.6985, -111.9059, -107.1576, -107.4254,
        -106.5140, -107.2136, -106.7788, -102.9794, -103.2151, -103.7466,
        -101.8395, -102.8046, -103.4071, -103.7755, -103.0027, -103.1748,
        -102.3555, -101.6226, -102.5289, -102.4732, -101.6932, -102.5270,
        -103.9653, -105.2408, -104.3983, -103.4864, -103.3293, -103.3143,
        -104.5031, -105.4398, -105.4648, -104.6025, -104.5618, -103.9399,
        -103.3349, -104.4650, -105.9080, -106.3502, -106.1938, -105.3786,
        -105.3050, -105.4919, -105.8384, -103.8080, -102.8830, -103.0485,
        -103.1135, -104.6375, -104.5717, -103.2917, -103.8626, -105.3205,
        -105.9806, -105.5826, -105.1708, -105.6363, -107.3540, -108.4909,
        -109.4608, -109.7906, -111.2699, -112.9582, -114.0260, -114.9570,
        -115.1018, -116.2176, -115.3161, -115.8524, -116.9248, -117.2088,
        -118.2925, -117.4678, -117.9366, -118.8234, -119.6211, -119.2798,
        -118.1053, -118.2270, -118.6067, -117.0974, -117.4401, -116.4409,
        -116.1399, -117.0794, -113.7789, -112.4879, -110.6871, -110.5610,
        -110.2702, -110.3789, -110.4180, -111.3665, -111.8380, -112.0311,
        -112.3504, -111.3953, -111.8876, -110.7403, -104.4855, -104.4516,
        -105.4529, -101.1632, -103.0099, -104.1326, -104.6414, -104.9698,
        -105.5535, -105.9976, -106.5577, -106.3803, -107.5496, -108.3838,
        -110.3474, -111.6016, -111.7445, -112.3716, -113.1326, -113.1804,
        -112.2471, -112.2687, -112.4789, -113.1446, -113.9326, -113.3910,
        -112.0282, -112.0963, -111.6093, -111.5751, -113.0161, -111.2297,
        -111.4028, -112.1693, -113.0170, -111.6982, -111.0730, -112.3366,
        -111.7733, -110.5898, -111.3943, -111.9934, -112.3548, -113.8014,
        -114.7949, -114.9640, -115.0399, -115.0936, -116.0119, -117.2004,
        -117.5761, -119.3917, -119.5647, -118.7122, -119.4574, -120.0096,
        -117.5686, -117.7677, -118.0038, -117.3283, -116.9187, -118.1088,
        -119.4132, -118.0528, -115.9470, -116.7491, -116.5388, -116.6357,
        -116.2764, -113.4072, -112.7709, -112.6971, -114.1477, -110.2662,
        -110.4973, -110.5382, -111.7107, -112.1198, -111.4531, -110.2209,
        -109.7263, -108.8343, -109.2043, -110.4199, -110.8662, -111.6835,
        -110.3383, -109.7702, -110.2524, -111.5302, -112.6199, -110.1628,
        -110.4340, -110.2107, -110.5446, -111.9675, -111.3367, -110.3196,
        -111.3993, -112.4554, -112.4204, -113.1429, -113.1240, -114.1867,
        -114.5823, -115.5266, -116.0555, -116.6543, -116.7139, -116.8564,
        -117.5759, -117.5710, -118.5675, -118.3019, -117.6995, -117.7829,
        -116.8034, -117.5383, -119.1904, -118.4204, -118.4773, -117.7189,
        -118.3169, -119.1472, -120.0013, -117.7166, -113.7822, -114.3316,
        -114.5232, -114.7566, -115.3181, -114.1922, -111.9374, -111.9630,
        -111.3969, -110.8889, -110.8172, -110.7016, -111.3170, -111.6842,
        -110.9017, -108.9314, -109.2892, -110.0022, -110.5508, -110.6622,
        -110.4882, -110.6641, -111.9952, -112.6138, -108.5681, -107.8625,
        -106.8294, -106.1358, -105.7332, -105.1973, -104.7705, -104.5245,
        -103.8623, -103.8533, -103.2412, -102.4357, -102.5601, -103.1884,
        -103.5025, -104.2574, -104.8644, -104.7310, -105.0868, -105.9695,
        -106.4449, -106.9923, -107.3656, -106.4310, -104.8039, -104.2851,
        -103.7286, -103.7952, -104.6404, -106.1456, -106.2673, -105.1758,
        -103.7507, -104.4778, -104.8059, -103.0029, -101.9865,  -98.7350,
         -97.1679,  -98.5344,  -98.6156,  -97.7073,  -97.7042,  -98.4825,
         -96.3404,  -97.6649,  -97.6684,  -98.4794,  -99.8598, -100.4401,
         -99.3858,  -95.1959,  -94.8417,  -95.9926,  -95.8389,  -95.3439,
         -94.5315,  -94.0249,  -94.1373,  -93.6422,  -93.2618,  -93.0841,
         -93.2466,  -94.1183,  -96.2831,  -96.6253,  -96.3606,  -96.1729,
         -93.0138,  -93.5202,  -93.3758,  -93.1007,  -92.3221,  -92.2430,
         -92.6348,  -93.2063,  -93.6428,  -93.1377,  -93.6340,  -94.2466,
         -94.0627,  -94.1842,  -94.5016,  -94.9245,  -93.6051,  -93.8431,
         -93.7546,  -93.6175,  -93.9090,  -93.2940,  -94.1309,  -93.9533,
         -92.1864,  -92.1158,  -92.5798,  -92.0489,  -90.8544,  -91.6993,
         -92.6717,  -91.8624,  -89.1598,  -89.4015,  -90.1248,  -91.1995,
         -91.3637,  -91.1278,  -90.0849,  -87.9853,  -89.1498,  -90.2839,
         -90.3296,  -90.4903,  -89.1686,  -88.6561,  -88.2760,  -87.8090,
         -86.6249,  -86.7899,  -87.0659,  -87.0288,  -88.3178,  -89.9819,
         -89.4598,  -89.0557,  -88.7013,  -85.9037,  -85.9662,  -87.5249,
         -88.3609,  -86.7870,  -84.3902,  -84.3119,  -83.6448,  -84.2419,
         -85.1496,  -84.3974,  -84.8706,  -84.6149,  -84.6428,  -84.2961,
         -85.0191,  -85.0449,  -85.4656,  -86.1165,  -85.8243,  -84.4655,
         -85.0763,  -84.9175,  -85.2141,  -85.7050,  -84.4092,  -84.3616,
         -83.5174,  -83.3725,  -83.7575,  -83.6641,  -84.0550,  -82.8697,
         -83.4496,  -84.2456,  -85.9310,  -87.0942,  -87.8796,  -86.2607,
         -87.9285,  -87.6961,  -81.3144,  -82.5960,  -83.5482,  -83.4855,
         -82.9152,  -83.7042,  -79.5289,  -78.0131,  -78.4653,  -78.7077,
         -78.9733,  -80.2189,  -80.4568,  -80.7651,  -81.3964,  -81.9722,
         -83.0407,  -84.0718,  -83.7616,  -83.8284,  -84.2012,  -83.9217,
         -82.9507,  -82.9273,  -83.3459,  -82.2893,  -81.8290,  -81.0961,
         -80.7891,  -81.3812,  -81.2691,  -78.8223,  -78.3337,  -79.2252,
         -78.0654,  -78.3870,  -78.1271,  -77.7087,  -77.3240,  -76.2244,
         -75.3978,  -75.7276,  -74.1431,  -73.0105,  -72.5439,  -71.0393,
         -70.4262,  -70.9107,  -69.5194,  -70.2349,  -70.7254,  -69.9998,
         -69.5624,  -68.7294,  -68.7115,  -68.3635,  -68.3285,  -65.2368,
         -64.5024,  -64.4609,  -65.6331,  -65.6559,  -64.8056,  -63.1353,
         -62.8414,  -63.3586,  -62.4420,  -62.3828,  -61.0163,  -59.6714,
         -60.5564,  -60.6274,  -60.5906,  -60.9245,  -59.7550,  -59.1763,
         -59.1346,  -59.3892,  -59.9317,  -56.3504,  -55.0982,  -53.0864,
         -51.7925,  -52.0974,  -49.9433,  -49.8495,  -48.4668,  -48.6687,
         -49.4637,  -48.5072,  -45.7209,  -43.4028,  -42.7649,  -41.6804,
         -40.2038,  -36.4190,  -35.7800,  -33.7443,  -33.8916,  -32.8584,
         -32.3103,  -32.8731,  -33.0409,  -32.9188,  -31.7977,  -31.0338,
         -30.9925,  -30.7323,  -28.6930,  -27.4016,  -26.4913,  -26.3459,
         -24.5560,  -21.3237,  -19.0468,  -16.9722,  -16.4112,  -15.2590,
         -13.5838,  -12.7999,  -12.8887,  -12.2321,  -12.0004,  -11.0830,
         -11.1823,  -11.4990,   -8.5426,   -7.8735,   -8.2943,   -8.6475,
          -7.0771,   -4.1380,   -1.8923,   -1.3897], device='cuda:0')
tensor([[-0.9056, -1.0509, -0.9346, -1.1957, -1.5661, -1.4430],
        [-0.7046, -1.5854, -1.5091, -0.9908, -1.0260, -0.6816],
        [-1.6696, -1.8877, -0.6306, -0.7886, -1.9251, -2.1732],
        ...,
        [-1.0337, -1.0268, -1.2525, -1.8373, -1.7430, -1.3113],
        [-1.2985, -1.4655, -1.3065, -0.6697, -0.6612, -1.2825],
        [-1.9151, -1.7604, -4.6751, -0.7503, -2.0019, -3.8961]],
       device='cuda:0', grad_fn=<StackBackward0>)
Traceback (most recent call last):
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 53, in <module>
    main()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 47, in main
    agent.train()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/REINFORCE.py", line 78, in train
    loss = self.update_policy(log_probs, discounted_rewards)
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/REINFORCE.py", line 112, in update_policy
    loss = -torch.sum(log_probs * discounted_rewards)
RuntimeError: The size of tensor a (6) must match the size of tensor b (1000) at non-singleton dimension 1
Traceback (most recent call last):
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 53, in <module>
    main()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/train.py", line 47, in main
    agent.train()
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/REINFORCE.py", line 78, in train
    loss = self.update_policy(log_probs, discounted_rewards)
  File "/gpfs/home1/alsrn50/MLIC_LAB/rl-study/mujuco_lab/nn/REINFORCE.py", line 112, in update_policy
    loss = -torch.sum(log_probs * discounted_rewards)
RuntimeError: The size of tensor a (6) must match the size of tensor b (1000) at non-singleton dimension 1
